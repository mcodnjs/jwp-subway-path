# jwp-subway-path

## API 기능 요구 사항
- [x] 노선에 역 등록 API 신규 구현
- [x] 노선에 역 제거 API 신규 구현
- [x] 노선 조회 API 수정
  - 노선에 포함된 역을 순서대로 보여주도록 응답 개선
- [x] 노선 목록 조회 API 수정
  - 노선에 포함된 역을 순서대로 보여주도록 응답 개선
- [x] (2단계) 경로 조회 API 구현
  - 최단 거리 경로와 거리 정보, 요금 정보

## API 명세

- 노선에 역 등록 API: POST /lines/{id}/stations
  - BODY: upStationId, downStationId, distance
- 노선에 역 제거 API: DELETE /lines/{id}/stations/{stationId}
- 노선 조회 API: GET /lines/{id}
- 모든 노선 조회 API: GET /lines
- 경로 조회 API: GET /path?srcStationId={srcStationId}&dstStationId={dstStationId}


## 비즈니스 규칙

- 노선에 역 등록
  - 등록 방식
    - 노선에 이미 등록되어있는 역을 기준으로 새로운 역을 등록합니다.
    - 기준이 되는 역이 없다면 등록할 수 없습니다.
    - 종점으로 등록 할 수 있다.
    - 노선에 역을 등록할 때, 거리 정보도 포함되어야 한다.
    - 노선에 등록된 역이 없는 경우, 두 역을 동시에 등록해야 한다.
    - 하나의 역은 여러 노선에 등록이 될 수 있다.
  - 갈래길 방지
    - 하나의 노선은 일직선으로 연결되야 합니다.
    - 상행역과 하행역이 이미 노선에 모두 등록되어 있다면 등록할 수 없습니다.
  - 거리 정보 관리
    - 거리는 양의 정수여야 한다.
    - 역 사이에 새로운 역을 등록할 경우 기존 역 사이 길이보다 크거나 같으면 등록을 할 수 없습니다.

- 노선에서 역을 제거
  - 종점 제거
  - 재배치
    - 노선에 A - B - C 역이 연결되어 있을 때 B역을 제거할 경우 A - C로 재배치합니다.
    - A - C의 거리는 A - B, B - C 의 거리 합으로 정합니다.
  - 노선에 두 개 역
    - 노선에 등록된 역이 2개 인 경우 하나의 역을 제거할 때 두 역이 모두 제거되어야 합니다.

- 경로 조회
  - 출발역과 도착역 사이의 최단 거리 경로 
    - 한 노선에서 경로 찾기 뿐만 아니라 여러 노선의 환승도 고려합니다.
  - 최단 거리 경로와 함께 총 거리 정보를 함께 응답합니다.
  - 경로 조회 시 요금 정보를 포함하여 응답합니다.
    - 기본운임(10㎞ 이내): 기본운임 1,250원
    - 이용 거리 초과 시 추가운임 부과
      10km~50km: 5km 까지 마다 100원 추가
      50km 초과: 8km 까지 마다 100원 추가

## 리팩토링 사항
- [x] Section 테이블에 order 추가
- [x] 도메인에게 책임 옮기기
- [x] 라인 정보 조회 API 합치기
- [x] 테스트 메서드 추가 및 메서드 분리
